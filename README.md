# Fedresurs Bankrot Parser 

Программа для автоматизированного сбора данных о банкротствах юридических и физических лиц с портала «Федресурс». Результатом работы является файл Excel, полностью готовый к аналитике и соответствующий требованиям ТЗ.

### Что делает программа
В отличие от простого парсинга одной страницы, данный инструмент реализует каскадный сбор данных:

* **Формирование реестра:** Программа обращается к эндпоинтам списка активных дел (`/cmpbankrupts` и `/prsnbankrupts`).
* **Глубокое обогащение:** Для каждой записи в реестре выполняется серия дополнительных запросов к API для получения детальной информации из карточки должника, данных о торгах и публикациях.
* **Консолидация:** Данные из 4-5 различных JSON-ответов объединяются в одну плоскую строку для Excel.

### Ключевые поля и логика их формирования
Чтобы данные в Excel были «чистыми» и логичными, реализованы следующие алгоритмы:

* **Оптимизация счетчиков:** Мы не скачиваем все списки торгов целиком. Программа делает запрос с `limit=1` и забирает значение `total` из метаданных ответа — так мы мгновенно получаем общее количество торгов/публикаций.
* **Выделение региона:** Поскольку в API адрес приходит одной строкой, реализован `RegionExtractor`, который парсит строку и вычленяет код или название субъекта РФ для удобной фильтрации в Excel.
* **Очистка данных:** Согласно ТЗ, реализован фильтр, который заменяет `null`, "н/д" и пустые строки на истинно пустые ячейки Excel, чтобы не портить статистику при анализе.

### Нюансы 
1.  **Сетевая вежливость (`SLEEP_MS`):** Портал чувствителен к частоте запросов. В коде установлена задержка в 200мс между обращениями. Если её убрать, есть риск получить блокировку по IP (ошибка 451/403).
2.  **Память и Apache POI:** Для формирования файла используется библиотека Apache POI. При объеме выгрузки более 1000 записей (как в критериях приемки) программа эффективно управляет потоками записи, чтобы не перегружать RAM.
3.  **Динамические URL:** Пути к API Федресурса вынесены в отдельный класс `FedresursEndpoints`. Это позволяет быстро адаптировать парсер, если сайт сменит версию API (например, с `/backend/` на что-то другое).

### Результат на выходе
На выходе получается файл `.xlsx` с двумя листами:

* **LegalEntities:** Юридические лица (21 колонка, включая ИНН, ОГРН, данные управляющего и статистику торгов).
* **PhysicalPersons:** Физические лица (18 колонок, включая СНИЛС, данные о регистрации ИП и статусы дел).
